Query 8 - Mongo DB

Determinar el promedio por género la opinión de embarazos accidentales con condón en un plazo en 1 año.

*Para hombre 

db.getCollection('CAH_Data').aggregate(
  [
    { $project: { Gender: 1, Condoms: 1 } },
    { $match: { Gender: 'Man' } },
    {
      $group: {
        _id: '$Gender',
        avg_Condoms: { $avg: '$Condoms' }
      }
    }
  ]
  { maxTimeMS: 60000, allowDiskUse: true }
);

*Para mujer 

db.getCollection('CAH_Data').aggregate(
  [
    { $project: { Gender: 1, Condoms: 1 } },
    { $match: { Gender: 'Woman' } },
    {
      $group: {
        _id: '$Gender',
        avg_Condoms: { $avg: '$Condoms' }
      }
    }
  ]
  { maxTimeMS: 60000, allowDiskUse: true }
);

Query 9 

Determinar el promedio por genero de la opinion de embarazos accidentales con anticonceptivos en un año.


*Por hombre 

db.getCollection('CAH_Data').aggregate(
  [
    { $project: { Gender: 1, Pill: 1 } },
    { $match: { Gender: 'Man' } },
    {
      $group: {
        _id: '$Gender',
        avg_Pill: { $avg: '$Pill' }
      }
    }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);


*Por Mujer

db.getCollection('CAH_Data').aggregate(
  [
    { $project: { Gender: 1, Pill: 1 } },
    { $match: { Gender: 'Woman' } },
    {
      $group: {
        _id: '$Gender',
        avg_Pill: { $avg: '$Pill' }
      }
    }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);


Query 10
Determinar el promedio por genero de la opinion de embarazos accidentales con método "Pulling out" en un año.

*por hombre 

db.getCollection('CAH_Data').aggregate(
  [
    { $project: { Gender: 1, PullingOut: 1 } },
    { $match: { Gender: 'Man' } },
    {
      $group: {
        _id: '$Gender',
        avg_PullingOut: { $avg: '$PullingOut' }
      }
    }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);

*por mujer 
db.getCollection('CAH_Data').aggregate(
  [
    { $project: { Gender: 1, PullingOut: 1 } },
    { $match: { Gender: 'Woman' } },
    {
      $group: {
        _id: '$Gender',
        avg_PullingOut: { $avg: '$PullingOut' }
      }
    }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);



***Prueba 

Los 5 estados que se consideran conformes con las leyes del aborto.


db.getCollection('CAH_Data').aggregate(
  [
    { $project: { StateLawViews: 1, State: 1 } },
    {
      $match: {
        StateLawViews:
          "My state's abortion laws are about right."
      }
    },
    {
      $group: {
        _id: '$State',
        count_StateLawViews: { $count: {} }
      }
    },
    { $sort: { count_StateLawViews: -1 } },
    { $limit: 5 }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);


Los 5 estados con más gente que consideran que sus estados deberían de tener más restricciones en leyes del aborto.

db.getCollection('CAH_Data').aggregate(
  [
    { $project: { StateLawViews: 1, State: 1 } },
    {
      $match: {
        StateLawViews:
          "My state's abortion laws should be more restrictive."
      }
    },
    {
      $group: {
        _id: '$State',
        count_StateLawViews: { $count: {} }
      }
    },
    { $sort: { count_StateLawViews: -1 } },
    { $limit: 5 }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);

Los 5 estados con más gente que consideran que sus estados deberían de ser más permisivos en leyes del aborto.

db.getCollection('CAH_Data').aggregate(
  [
    { $project: { StateLawViews: 1, State: 1 } },
    {
      $match: {
        StateLawViews:
          "My state's abortion laws should be more permissive."
      }
    },
    {
      $group: {
        _id: '$State',
        count_StateLawViews: { $count: {} }
      }
    },
    { $sort: { count_StateLawViews: -1 } },
    { $limit: 5 }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);


Los 5 estados con más gente que no están familiarizados con sus leyes del aborto.

db.getCollection('CAH_Data').aggregate(
  [
    { $project: { StateLawViews: 1, State: 1 } },
    {
      $match: {
        StateLawViews:
          "I'm not familiar with my state's abortion laws."
      }
    },
    {
      $group: {
        _id: '$State',
        count_StateLawViews: { $count: {} }
      }
    },
    { $sort: { count_StateLawViews: -1 } },
    { $limit: 5 }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);


Query 7 
¿Cuántas personas de acuerdo a su percepción politica ven la pena de muerte? 

*Está justificada

db.getCollection('CAH_Data').aggregate(
  [
    {
      $project: {
        DeathPenaltyViews: 1,
        PoliticalViews: 1
      }
    },
    {
      $match: {
        DeathPenaltyViews:
          'When someone commits multiple murders, the death penalty is morally justified.'
      }
    },
    {
      $group: {
        _id: '$PoliticalViews',
        count_DeathPenaltyViews: { $count: {} }
      }
    },
    { $sort: { count_DeathPenaltyViews: -1 } }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);

No esta justificada 

db.getCollection('CAH_Data').aggregate(
  [
    {
      $project: {
        DeathPenaltyViews: 1,
        PoliticalViews: 1
      }
    },
    {
      $match: {
        DeathPenaltyViews:
          'The death penalty is morally wrong, even when someone commits multiple murders.'
      }
    },
    {
      $group: {
        _id: '$PoliticalViews',
        count_DeathPenaltyViews: { $count: {} }
      }
    },
    { $sort: { count_DeathPenaltyViews: -1 } }
  ],
  { maxTimeMS: 60000, allowDiskUse: true }
);
